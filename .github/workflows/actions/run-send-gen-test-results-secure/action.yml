name: "Run Send Generate Test Results"
description: "Run the send-results script to push raw test results to the Allure server"
author: "sheldon.regular@gmail.com"
inputs:
  RESULTS_LOCATION:
    description: "Location of the raw test results generated by Allure"
    required: true
    default: "allure-results"
  ALLURE_SERVER:
    description: "URL of the Allure Service"
    required: true
    default: "https://allure-mobile.vonx.io/api"
  REPORT_PROJECT:
    description: "Name of the project the Allure Service is using to store these results"
    required: true
    default: "acapy"
  ADMIN_USER:
    description: "Username of the Allure Adminstrator"
    required: true
  ADMIN_PW:
    description: "Password of the Allure Adminstrator"
    required: true
runs:
  using: "composite"
  steps:
    - name: run-send-gen-test-results-secure
      working-directory: aries-mobile-test-harness
      env:
        NO_TTY: "1"
        RESULTS_LOCATION: ${{ inputs.RESULTS_LOCATION }}
        ALLURE_SERVER: ${{ inputs.ALLURE_SERVER }}
        REPORT_PROJECT: ${{ inputs.REPORT_PROJECT }}
        ADMIN_USER: ${{ inputs.ADMIN_USER }}
        ADMIN_PW: ${{ inputs.ADMIN_PW }}
      run: ./aries-mobile-tests/allure/send_results_secure.sh $RESULTS_LOCATION $ALLURE_SERVER -p $REPORT_PROJECT $ADMIN_USER $ADMIN_PW
      shell: bash
branding:
  icon: "mic"
  color: "purple"
